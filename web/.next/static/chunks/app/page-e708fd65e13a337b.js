(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2665:(e,t,n)=>{"use strict";var s=n(2405);n.o(s,"usePathname")&&n.d(t,{usePathname:function(){return s.usePathname}}),n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}})},4722:(e,t,n)=>{"use strict";n.d(t,{F:()=>r});class s{setToken(e){this.token=e,e?localStorage.setItem("token",e):localStorage.removeItem("token")}getToken(){return this.token||(this.token=localStorage.getItem("token")),this.token}async request(e,t,n){let s={"Content-Type":"application/json"},r=this.getToken();r&&(s.Authorization="Bearer ".concat(r));let o=await fetch("".concat("/api/v1").concat(t),{method:e,headers:s,body:n?JSON.stringify(n):void 0});if(401===o.status)throw this.setToken(null),window.location.href="/login",Error("Unauthorized");if(!o.ok)throw Error((await o.json().catch(()=>({message:o.statusText}))).message||o.statusText);return o.json()}get(e){return this.request("GET",e)}post(e,t){return this.request("POST",e,t)}put(e,t){return this.request("PUT",e,t)}delete(e){return this.request("DELETE",e)}constructor(){this.token=null}}let r=new s},5485:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>a});var s=n(5896),r=n(3684),o=n(2665),u=n(9064);function a(){let{user:e,isLoading:t}=(0,u.A)(),n=(0,o.useRouter)();return(0,r.useEffect)(()=>{t||n.replace(e?"/dashboard":"/login")},[e,t,n]),(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-pulse text-lg text-gray-500",children:"جاري التحميل..."})})}},7128:(e,t,n)=>{Promise.resolve().then(n.bind(n,5485))},9064:(e,t,n)=>{"use strict";n.d(t,{A:()=>i,AuthProvider:()=>a});var s=n(5896),r=n(3684),o=n(4722);let u=(0,r.createContext)(void 0);function a(e){let{children:t}=e,[n,a]=(0,r.useState)(null),[i,l]=(0,r.useState)(!0);(0,r.useEffect)(()=>{o.F.getToken()?o.F.get("/auth/profile").then(e=>a(e)).catch(()=>{o.F.setToken(null)}).finally(()=>l(!1)):l(!1)},[]);let c=async(e,t)=>{let n=await o.F.post("/auth/login",{login:e,password:t});o.F.setToken(n.accessToken),a(n.user)};return(0,s.jsx)(u.Provider,{value:{user:n,isLoading:i,login:c,logout:()=>{o.F.setToken(null),a(null),window.location.href="/login"}},children:t})}function i(){let e=(0,r.useContext)(u);if(!e)throw Error("useAuth must be used within AuthProvider");return e}}},e=>{e.O(0,[880,977,358],()=>e(e.s=7128)),_N_E=e.O()}]);