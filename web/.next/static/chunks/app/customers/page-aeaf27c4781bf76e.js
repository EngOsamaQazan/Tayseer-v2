(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[812],{3631:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>n});var a=s(5896),r=s(3684),l=s(4722);function n(){let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)(0),[d,c]=(0,r.useState)(1),[o,m]=(0,r.useState)(1),[x,u]=(0,r.useState)(!0),[h,p]=(0,r.useState)(""),[g,b]=(0,r.useState)(""),[y,j]=(0,r.useState)(!1),f=(0,r.useCallback)(async()=>{u(!0);try{let e=new URLSearchParams({page:String(d),limit:"20"});g&&e.set("search",g);let s=await l.F.get("/customers?".concat(e.toString()));t(s.data),n(s.total),m(s.totalPages)}catch(e){p(e instanceof Error?e.message:"فشل تحميل العملاء")}finally{u(!1)}},[d,g]);return(0,r.useEffect)(()=>{f()},[f]),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"العملاء"}),(0,a.jsxs)("p",{className:"text-gray-500 text-sm",children:["إجمالي: ",s," عميل"]})]}),(0,a.jsx)("button",{onClick:()=>j(!y),className:"bg-emerald-600 text-white px-4 py-2 rounded-lg text-sm hover:bg-emerald-700 transition-colors",children:"+ إضافة عميل"})]}),y&&(0,a.jsx)(i,{onSuccess:()=>{j(!1),f()},onCancel:()=>j(!1)}),(0,a.jsxs)("div",{className:"bg-white rounded-xl border mb-4",children:[(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),c(1),f()},className:"flex items-center gap-3 p-4 border-b",children:[(0,a.jsx)("input",{type:"text",value:g,onChange:e=>b(e.target.value),placeholder:"بحث بالاسم أو رقم الهوية أو الهاتف...",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500"}),(0,a.jsx)("button",{type:"submit",className:"bg-slate-700 text-white px-4 py-2 rounded-lg text-sm hover:bg-slate-800",children:"بحث"})]}),h&&(0,a.jsx)("div",{className:"bg-red-50 text-red-700 p-4 text-sm",children:h}),x?(0,a.jsx)("div",{className:"p-8 text-center text-gray-500 animate-pulse",children:"جاري التحميل..."}):0===e.length?(0,a.jsx)("div",{className:"p-8 text-center text-gray-400",children:"لا يوجد عملاء بعد"}):(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b bg-gray-50 text-gray-600",children:[(0,a.jsx)("th",{className:"px-4 py-3 text-start font-medium",children:"#"}),(0,a.jsx)("th",{className:"px-4 py-3 text-start font-medium",children:"الاسم"}),(0,a.jsx)("th",{className:"px-4 py-3 text-start font-medium",children:"رقم الهوية"}),(0,a.jsx)("th",{className:"px-4 py-3 text-start font-medium",children:"الهاتف"}),(0,a.jsx)("th",{className:"px-4 py-3 text-start font-medium",children:"البريد"}),(0,a.jsx)("th",{className:"px-4 py-3 text-start font-medium",children:"المدينة"}),(0,a.jsx)("th",{className:"px-4 py-3 text-start font-medium",children:"تاريخ التسجيل"})]})}),(0,a.jsx)("tbody",{children:e.map((e,t)=>(0,a.jsxs)("tr",{className:"border-b last:border-0 hover:bg-gray-50 transition-colors",children:[(0,a.jsx)("td",{className:"px-4 py-3 text-gray-500",children:(d-1)*20+t+1}),(0,a.jsx)("td",{className:"px-4 py-3 font-medium",children:e.name}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-600",children:e.idNumber||"-"}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-600",children:e.primaryPhoneNumber||"-"}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-600",children:e.email||"-"}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-600",children:e.city||"-"}),(0,a.jsx)("td",{className:"px-4 py-3 text-gray-500",children:new Date(e.createdAt).toLocaleDateString("ar-SA")})]},e.id))})]})}),o>1&&(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-t",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["صفحة ",d," من ",o]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>c(e=>Math.max(1,e-1)),disabled:1===d,className:"px-3 py-1 border rounded text-sm disabled:opacity-40",children:"السابق"}),(0,a.jsx)("button",{onClick:()=>c(e=>Math.min(o,e+1)),disabled:d===o,className:"px-3 py-1 border rounded text-sm disabled:opacity-40",children:"التالي"})]})]})]})]})}function i(e){let{onSuccess:t,onCancel:s}=e,[n,i]=(0,r.useState)({name:"",idNumber:"",primaryPhoneNumber:"",email:"",city:""}),[d,c]=(0,r.useState)(!1),[o,m]=(0,r.useState)(""),x=async e=>{e.preventDefault(),c(!0),m("");try{await l.F.post("/customers",n),t()}catch(e){m(e instanceof Error?e.message:"فشل إضافة العميل")}finally{c(!1)}};return(0,a.jsxs)("div",{className:"bg-white rounded-xl border p-6 mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"إضافة عميل جديد"}),o&&(0,a.jsx)("div",{className:"bg-red-50 text-red-700 p-3 rounded mb-4 text-sm",children:o}),(0,a.jsxs)("form",{onSubmit:x,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"الاسم الكامل *"}),(0,a.jsx)("input",{type:"text",required:!0,value:n.name,onChange:e=>i({...n,name:e.target.value}),className:"w-full px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-emerald-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رقم الهوية *"}),(0,a.jsx)("input",{type:"text",required:!0,value:n.idNumber,onChange:e=>i({...n,idNumber:e.target.value}),className:"w-full px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-emerald-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"رقم الهاتف"}),(0,a.jsx)("input",{type:"text",value:n.primaryPhoneNumber,onChange:e=>i({...n,primaryPhoneNumber:e.target.value}),className:"w-full px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-emerald-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"البريد الإلكتروني"}),(0,a.jsx)("input",{type:"email",value:n.email,onChange:e=>i({...n,email:e.target.value}),className:"w-full px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-emerald-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"المدينة"}),(0,a.jsx)("input",{type:"text",value:n.city,onChange:e=>i({...n,city:e.target.value}),className:"w-full px-3 py-2 border rounded-lg text-sm focus:ring-2 focus:ring-emerald-500"})]}),(0,a.jsxs)("div",{className:"flex items-end gap-2",children:[(0,a.jsx)("button",{type:"submit",disabled:d,className:"bg-emerald-600 text-white px-6 py-2 rounded-lg text-sm hover:bg-emerald-700 disabled:opacity-50",children:d?"جاري الحفظ...":"حفظ"}),(0,a.jsx)("button",{type:"button",onClick:s,className:"bg-gray-200 text-gray-700 px-6 py-2 rounded-lg text-sm hover:bg-gray-300",children:"إلغاء"})]})]})]})}},4722:(e,t,s)=>{"use strict";s.d(t,{F:()=>r});class a{setToken(e){this.token=e,e?localStorage.setItem("token",e):localStorage.removeItem("token")}getToken(){return this.token||(this.token=localStorage.getItem("token")),this.token}async request(e,t,s){let a={"Content-Type":"application/json"},r=this.getToken();r&&(a.Authorization="Bearer ".concat(r));let l=await fetch("".concat("/api/v1").concat(t),{method:e,headers:a,body:s?JSON.stringify(s):void 0});if(401===l.status)throw this.setToken(null),window.location.href="/login",Error("Unauthorized");if(!l.ok)throw Error((await l.json().catch(()=>({message:l.statusText}))).message||l.statusText);return l.json()}get(e){return this.request("GET",e)}post(e,t){return this.request("POST",e,t)}put(e,t){return this.request("PUT",e,t)}delete(e){return this.request("DELETE",e)}constructor(){this.token=null}}let r=new a},8228:(e,t,s)=>{Promise.resolve().then(s.bind(s,3631))}},e=>{e.O(0,[880,977,358],()=>e(e.s=8228)),_N_E=e.O()}]);