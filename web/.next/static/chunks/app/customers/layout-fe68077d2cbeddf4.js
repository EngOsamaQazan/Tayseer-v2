(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[759],{2932:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(5896),n=s(3684),l=s(2665),a=s(9064),o=s(9241);function i(e){let{children:t}=e,{user:s,isLoading:i}=(0,a.A)(),c=(0,l.useRouter)();return((0,n.useEffect)(()=>{i||s||c.replace("/login")},[s,i,c]),i)?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-pulse text-lg text-gray-500",children:"جاري التحميل..."})}):s?(0,r.jsxs)("div",{className:"flex min-h-screen",children:[(0,r.jsx)(o.A,{}),(0,r.jsx)("main",{className:"flex-1 p-6 overflow-auto",children:t})]}):null}},4722:(e,t,s)=>{"use strict";s.d(t,{F:()=>n});class r{setToken(e){this.token=e,e?localStorage.setItem("token",e):localStorage.removeItem("token")}getToken(){return this.token||(this.token=localStorage.getItem("token")),this.token}async request(e,t,s){let r={"Content-Type":"application/json"},n=this.getToken();n&&(r.Authorization="Bearer ".concat(n));let l=await fetch("".concat("/api/v1").concat(t),{method:e,headers:r,body:s?JSON.stringify(s):void 0});if(401===l.status)throw this.setToken(null),window.location.href="/login",Error("Unauthorized");if(!l.ok)throw Error((await l.json().catch(()=>({message:l.statusText}))).message||l.statusText);return l.json()}get(e){return this.request("GET",e)}post(e,t){return this.request("POST",e,t)}put(e,t){return this.request("PUT",e,t)}delete(e){return this.request("DELETE",e)}constructor(){this.token=null}}let n=new r},8641:(e,t,s)=>{Promise.resolve().then(s.bind(s,2932))},9064:(e,t,s)=>{"use strict";s.d(t,{A:()=>i,AuthProvider:()=>o});var r=s(5896),n=s(3684),l=s(4722);let a=(0,n.createContext)(void 0);function o(e){let{children:t}=e,[s,o]=(0,n.useState)(null),[i,c]=(0,n.useState)(!0);(0,n.useEffect)(()=>{l.F.getToken()?l.F.get("/auth/profile").then(e=>o(e)).catch(()=>{l.F.setToken(null)}).finally(()=>c(!1)):c(!1)},[]);let u=async(e,t)=>{let s=await l.F.post("/auth/login",{login:e,password:t});l.F.setToken(s.accessToken),o(s.user)};return(0,r.jsx)(a.Provider,{value:{user:s,isLoading:i,login:u,logout:()=>{l.F.setToken(null),o(null),window.location.href="/login"}},children:t})}function i(){let e=(0,n.useContext)(a);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},9241:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var r=s(5896),n=s(1716),l=s.n(n),a=s(2665),o=s(9064);let i=[{href:"/dashboard",label:"لوحة التحكم",icon:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})},{href:"/customers",label:"العملاء",icon:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}];function c(){var e,t;let s=(0,a.usePathname)(),{user:n,logout:c}=(0,o.A)();return(0,r.jsxs)("aside",{className:"w-64 bg-slate-800 text-white flex flex-col min-h-screen",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-slate-700",children:[(0,r.jsx)("h1",{className:"text-xl font-bold text-emerald-400",children:"نظام تيسير"}),(0,r.jsx)("p",{className:"text-slate-400 text-sm mt-1",children:(null==n?void 0:n.tenantName)||"ERP System"})]}),(0,r.jsx)("nav",{className:"flex-1 py-4",children:i.map(e=>{let t=s===e.href;return(0,r.jsxs)(l(),{href:e.href,className:"flex items-center gap-3 px-6 py-3 text-sm transition-colors ".concat(t?"bg-emerald-600 text-white border-l-4 border-emerald-300":"text-slate-300 hover:bg-slate-700 hover:text-white"),children:[e.icon,(0,r.jsx)("span",{children:e.label})]},e.href)})}),(0,r.jsxs)("div",{className:"p-4 border-t border-slate-700",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-emerald-500 rounded-full flex items-center justify-center text-sm font-bold",children:(null==n||null==(t=n.username)||null==(e=t[0])?void 0:e.toUpperCase())||"U"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:null==n?void 0:n.username}),(0,r.jsx)("p",{className:"text-xs text-slate-400",children:null==n?void 0:n.role})]})]}),(0,r.jsx)("button",{onClick:c,className:"w-full text-sm text-slate-400 hover:text-red-400 py-1 transition-colors text-start",children:"تسجيل الخروج"})]})]})}}},e=>{e.O(0,[628,880,977,358],()=>e(e.s=8641)),_N_E=e.O()}]);