(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{4722:(t,e,o)=>{"use strict";o.d(e,{F:()=>s});class n{setToken(t){this.token=t,t?localStorage.setItem("token",t):localStorage.removeItem("token")}getToken(){return this.token||(this.token=localStorage.getItem("token")),this.token}async request(t,e,o){let n={"Content-Type":"application/json"},s=this.getToken();s&&(n.Authorization="Bearer ".concat(s));let r=await fetch("".concat("/api/v1").concat(e),{method:t,headers:n,body:o?JSON.stringify(o):void 0});if(401===r.status)throw this.setToken(null),window.location.href="/login",Error("Unauthorized");if(!r.ok)throw Error((await r.json().catch(()=>({message:r.statusText}))).message||r.statusText);return r.json()}get(t){return this.request("GET",t)}post(t,e){return this.request("POST",t,e)}put(t,e){return this.request("PUT",t,e)}delete(t){return this.request("DELETE",t)}constructor(){this.token=null}}let s=new n},5325:()=>{},9064:(t,e,o)=>{"use strict";o.d(e,{A:()=>l,AuthProvider:()=>u});var n=o(5896),s=o(3684),r=o(4722);let i=(0,s.createContext)(void 0);function u(t){let{children:e}=t,[o,u]=(0,s.useState)(null),[l,a]=(0,s.useState)(!0);(0,s.useEffect)(()=>{r.F.getToken()?r.F.get("/auth/profile").then(t=>u(t)).catch(()=>{r.F.setToken(null)}).finally(()=>a(!1)):a(!1)},[]);let h=async(t,e)=>{let o=await r.F.post("/auth/login",{login:t,password:e});r.F.setToken(o.accessToken),u(o.user)};return(0,n.jsx)(i.Provider,{value:{user:o,isLoading:l,login:h,logout:()=>{r.F.setToken(null),u(null),window.location.href="/login"}},children:e})}function l(){let t=(0,s.useContext)(i);if(!t)throw Error("useAuth must be used within AuthProvider");return t}},9473:(t,e,o)=>{Promise.resolve().then(o.t.bind(o,5325,23)),Promise.resolve().then(o.bind(o,9064))}},t=>{t.O(0,[90,880,977,358],()=>t(t.s=9473)),_N_E=t.O()}]);