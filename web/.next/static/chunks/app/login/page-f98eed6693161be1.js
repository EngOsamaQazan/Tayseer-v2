(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[520],{2235:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var s=r(5896),a=r(3684),n=r(2665),o=r(9064);function l(){let{login:e,user:t,isLoading:r}=(0,o.A)(),l=(0,n.useRouter)(),[i,u]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[h,m]=(0,a.useState)(""),[x,g]=(0,a.useState)(!1);if(r)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-emerald-900",children:(0,s.jsx)("div",{className:"text-white text-lg animate-pulse",children:"جاري التحميل..."})});if(t)return l.replace("/dashboard"),null;let f=async t=>{t.preventDefault(),m(""),g(!0);try{await e(i,d),l.push("/dashboard")}catch(e){m(e instanceof Error?e.message:"فشل تسجيل الدخول")}finally{g(!1)}};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-emerald-900 p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md p-8",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-emerald-500 rounded-2xl mx-auto flex items-center justify-center mb-4",children:(0,s.jsx)("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"نظام تيسير"}),(0,s.jsx)("p",{className:"text-gray-500 mt-1",children:"تسجيل الدخول إلى حسابك"})]}),h&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4 text-sm",children:h}),(0,s.jsxs)("form",{onSubmit:f,className:"space-y-5",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"login",className:"block text-sm font-medium text-gray-700 mb-1",children:"اسم المستخدم أو البريد الإلكتروني"}),(0,s.jsx)("input",{id:"login",type:"text",value:i,onChange:e=>u(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors",placeholder:"admin",required:!0,autoFocus:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"كلمة المرور"}),(0,s.jsx)("input",{id:"password",type:"password",value:d,onChange:e=>c(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors",placeholder:"••••••••",required:!0})]}),(0,s.jsx)("button",{type:"submit",disabled:x,className:"w-full bg-emerald-600 text-white py-3 rounded-lg font-medium hover:bg-emerald-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:x?"جاري الدخول...":"تسجيل الدخول"})]}),(0,s.jsxs)("p",{className:"mt-6 text-center text-xs text-gray-400",children:["Tayseer ERP v2.0 \xa9 ",new Date().getFullYear()]})]})})}},2665:(e,t,r)=>{"use strict";var s=r(2405);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},4722:(e,t,r)=>{"use strict";r.d(t,{F:()=>a});class s{setToken(e){this.token=e,e?localStorage.setItem("token",e):localStorage.removeItem("token")}getToken(){return this.token||(this.token=localStorage.getItem("token")),this.token}async request(e,t,r){let s={"Content-Type":"application/json"},a=this.getToken();a&&(s.Authorization="Bearer ".concat(a));let n=await fetch("".concat("/api/v1").concat(t),{method:e,headers:s,body:r?JSON.stringify(r):void 0});if(401===n.status)throw this.setToken(null),window.location.href="/login",Error("Unauthorized");if(!n.ok)throw Error((await n.json().catch(()=>({message:n.statusText}))).message||n.statusText);return n.json()}get(e){return this.request("GET",e)}post(e,t){return this.request("POST",e,t)}put(e,t){return this.request("PUT",e,t)}delete(e){return this.request("DELETE",e)}constructor(){this.token=null}}let a=new s},9064:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,AuthProvider:()=>l});var s=r(5896),a=r(3684),n=r(4722);let o=(0,a.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,a.useState)(null),[i,u]=(0,a.useState)(!0);(0,a.useEffect)(()=>{n.F.getToken()?n.F.get("/auth/profile").then(e=>l(e)).catch(()=>{n.F.setToken(null)}).finally(()=>u(!1)):u(!1)},[]);let d=async(e,t)=>{let r=await n.F.post("/auth/login",{login:e,password:t});n.F.setToken(r.accessToken),l(r.user)};return(0,s.jsx)(o.Provider,{value:{user:r,isLoading:i,login:d,logout:()=>{n.F.setToken(null),l(null),window.location.href="/login"}},children:t})}function i(){let e=(0,a.useContext)(o);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},9848:(e,t,r)=>{Promise.resolve().then(r.bind(r,2235))}},e=>{e.O(0,[880,977,358],()=>e(e.s=9848)),_N_E=e.O()}]);